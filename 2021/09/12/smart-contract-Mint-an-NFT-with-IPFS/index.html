<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>é€šè¿‡ IPFS é“¸é€  NFT(ä¸€) | é£é›ªå›´åŸ</title>

  
  <meta name="author" content="YueGS">
  

  
  <meta name="description" content="æœ¬ç¯‡æ˜¯ä¸€ç¯‡ç¿»è¯‘ï¼ŒåŸæ–‡æ¥è‡ª Mint an NFT with IPFSï¼Œä»¥ä¸‹æ˜¯è¯‘æ–‡ã€‚
 éåŒè´¨åŒ– tokenï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå¹¶ä½¿ç”¨æ•°å­—äº§å“è¿›è¡Œä»·å€¼äº¤æ¢ã€‚æœ‰äº›å¹³å°æœåŠ¡ï¼ˆæ¯”å¦‚è¯´ï¼Œ Pinata å’Œ nft.storageï¼‰å¯ä»¥å¸®åŠ©ä½ ä»é›¶å¼€å§‹é“¸é€ ä¸€ä¸ª NFT tokenï¼Œå¹¶å°†å…¶å­˜å‚¨å† IPFS ä¸Šã€‚">
  

  
  
  <meta name="keywords" content="æ™ºèƒ½åˆçº¦">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="é€šè¿‡ IPFS é“¸é€  NFT(ä¸€)"/>

  <meta property="og:site_name" content="é£é›ªå›´åŸ"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="é£é›ªå›´åŸ" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">é£é›ªå›´åŸ</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/about">About</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>é€šè¿‡ IPFS é“¸é€  NFT(ä¸€)</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2021/09/12/smart-contract-Mint-an-NFT-with-IPFS/" rel="bookmark">
        <time class="entry-date published" datetime="2021-09-12T15:01:28.000Z">
          2021-09-12
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <p>æœ¬ç¯‡æ˜¯ä¸€ç¯‡ç¿»è¯‘ï¼ŒåŸæ–‡æ¥è‡ª <a target="_blank" rel="noopener" href="https://docs.ipfs.io/how-to/mint-nfts-with-ipfs/#a-short-introduction-to-nfts">Mint an NFT with IPFS</a>ï¼Œä»¥ä¸‹æ˜¯è¯‘æ–‡ã€‚</p>
<p> éåŒè´¨åŒ– tokenï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå¹¶ä½¿ç”¨æ•°å­—äº§å“è¿›è¡Œä»·å€¼äº¤æ¢ã€‚æœ‰äº›å¹³å°æœåŠ¡ï¼ˆæ¯”å¦‚è¯´ï¼Œ <a target="_blank" rel="noopener" href="https://pinata.cloud/">Pinata</a> å’Œ <a target="_blank" rel="noopener" href="https://nft.storage/">nft.storage</a>ï¼‰å¯ä»¥å¸®åŠ©ä½ ä»é›¶å¼€å§‹é“¸é€ ä¸€ä¸ª NFT tokenï¼Œå¹¶å°†å…¶å­˜å‚¨å† IPFS ä¸Šã€‚</p>
<span id="more"></span>
<h3 id="NFTs-ç®€ä»‹"><a href="#NFTs-ç®€ä»‹" class="headerlink" title="NFTs ç®€ä»‹"></a>NFTs ç®€ä»‹</h3><p>è¿™ç¯‡æ–‡ç« ä¸å»æ¢ç©¶ NFTs çš„å¤æ‚æ€§ä¸é‡è¦æ€§ï¼Œä»…ä»…æ˜¯å¸®åŠ©ä½ ç†è§£ï¼Œå¦‚ä½•åœ¨ IPFS ä¸Šæ‰˜ç®¡ NFTs,ä»¥åŠè¯¥è¿‡ç¨‹ä¸­æ‰€æ¶‰åŠåˆ°çš„åŒºå—é“¾å¼€å‘ã€‚<br>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†åœ¨æ­¤è¦†ç›– NFTs ä¸­éå¸¸åŸºç¡€çš„çŸ¥è¯†ï¼Œè®©æ¯ä¸ªäººéƒ½åœ¨ç›¸åŒçš„èµ·è·‘çº¿ä¸Šã€‚å¦‚æœä½ å¯¹ NFT çš„æœ€ä½³å®è·µå’Œ NFT å¼€å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¯ä»¥å» <a target="_blank" rel="noopener" href="https://nftschool.dev/">NFT School</a> åšæ›´æ·±å…¥çš„äº†è§£ã€‚</p>
<h4 id="NFTs-ç»„æˆ"><a href="#NFTs-ç»„æˆ" class="headerlink" title="NFTs ç»„æˆ"></a>NFTs ç»„æˆ</h4><p>è¿™é‡Œæœ‰äº›é€šç”¨å±æ€§æ¥å®šä¹‰ NFTã€‚<br>é¦–å…ˆï¼Œæ¯ä¸ª NFT éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ idï¼Œä»¥ä½œç›¸äº’åŒºåˆ†ã€‚è¿™ä¸€ç‚¹å’ŒåŒè´¨åŒ– token ï¼ˆæ¯”å¦‚ ETHï¼‰æœ‰ç€é²œæ˜çš„å·®å¼‚ï¼ŒåŒè´¨åŒ– token å¤§é‡ç»‘å®šåœ¨åŒä¸€ä¸ªè´¦æˆ·æˆ–è€…é’±åŒ…ä¸Šï¼Œæ¯ä¸ª åŒè´¨åŒ– token æ— æ³•åšåŒºåˆ†ã€‚ç”±äºæ¯ä¸ª NFT éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå®ƒä»¬åªèƒ½è¢«å•ç‹¬çš„æ‹¥æœ‰&#x2F;äº¤æ˜“ï¼Œå¹¶ä½¿ç”¨æ™ºèƒ½åˆçº¦ï¼Œç¡®ä¿è°æ‹¥æœ‰äº†ä»€ä¹ˆ NFTã€‚</p>
<p>å¦å¤–ä¸€ä¸ªå…³é”®å±æ€§ï¼ŒNFT æœ‰èƒ½åŠ›é“¾æ¥å­˜å‚¨åœ¨æ™ºèƒ½åˆçº¦ä»¥å¤–çš„æ•°æ®ã€‚å­˜å‚¨å’Œå¤„ç†æ™ºèƒ½åˆçº¦å¤–éƒ¨çš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé“¾ä¸‹æ“ä½œï¼ˆoff-chainï¼‰ã€‚ç”±äºå­˜å‚¨åœ¨é“¾ä¸Šçš„æ•°æ®éœ€è¦è¢«å¤„ç†&#x2F;éªŒè¯&#x2F;å¹¶è¢«å¤åˆ¶åˆ°æ•´ä¸ªåŒºå—é“¾ç½‘ç»œï¼Œå› æ­¤ï¼Œåœ¨é“¾ä¸Šå­˜å‚¨å¤§é‡æ•°æ®æ˜¯éå¸¸æ˜‚è´µçš„ã€‚å¯¹äºå¤§å¤šæ•° NFT åº”ç”¨åœºæ™¯æ¥è¯´ï¼Œè¿™éƒ½ä¼šæ˜¯ä¸ªé—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å½“ token æ‰€ä»£è¡¨çš„æ˜¯æ•°å­—è—å“æˆ–è€…è‰ºæœ¯å“æ—¶ï¼Œå­˜å‚¨æ‰€æœ‰çš„ä½œå“å¯èƒ½éœ€è¦èŠ±è´¹æ•°ç™¾ä¸‡ç¾é‡‘ã€‚</p>
<h4 id="IPFS-å¦‚ä½•å‘æŒ¥ä½œç”¨"><a href="#IPFS-å¦‚ä½•å‘æŒ¥ä½œç”¨" class="headerlink" title="IPFS å¦‚ä½•å‘æŒ¥ä½œç”¨"></a>IPFS å¦‚ä½•å‘æŒ¥ä½œç”¨</h4><p>å½“ NFT è¢«åˆ›å»ºï¼Œå¹¶é“¾æ¥åˆ°å¤„äºå…¶ä»–ç³»ç»Ÿä¸­çš„æ•°å­—æ–‡ä»¶æ—¶ï¼Œå¦‚ä½•å®Œæˆè¿™ç§é“¾æ¥ï¼Œå°±æ˜¾å¾—éå¸¸é‡è¦äº†ã€‚è¿™é‡Œæœ‰ä¸€äº›ç†ç”±ï¼Œè¯´æ˜ä¸ºä»€ä¹ˆ http é“¾æ¥å¹¶ä¸é€‚åˆç”¨åœ¨è¿™é‡Œã€‚</p>
<p>HTTP åœ°å€ï¼Œç±»ä¼¼äº <code>https://cloud-bucket.provider.com/my-nft.jpeg</code>, åªè¦å…¶å­˜æ”¾çš„æœåŠ¡å™¨æ²¡æœ‰è¢«å…³é—­ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥è·å–åˆ° <code>my-nft.jpeg</code> çš„å†…å®¹ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åŠæ³•ä¿è¯ï¼Œ<code>jmy-nft.jpeg</code> çš„å†…å®¹å’Œæˆ‘ä»¬åˆ›å»º NFT æ—¶çš„å†…å®¹æ˜¯ä¸€æ ·çš„ã€‚æœåŠ¡å™¨çš„æ‹¥æœ‰è€…å¯ä»¥å¾ˆè½»æ¾çš„æ›¿æ¢ <code>my-nft.jpeg</code> çš„å†…å®¹ï¼Œè¿™å°†å¯¼è‡´ NFT ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ã€‚</p>
<p>è¿™ç§é—®é¢˜ï¼Œå·²ç»è¢«ä¸€ä¸ªè‰ºæœ¯å®¶ç©è¿‡äº†ï¼Œ<a target="_blank" rel="noopener" href="https://cointelegraph.com/news/opensea-collector-pulls-the-rug-on-nfts-to-highlight-arbitrary-value">pulled the rug</a>ã€‚</p>
<p>IPFS é€šè¿‡ <a target="_blank" rel="noopener" href="https://docs.ipfs.io/concepts/content-addressing/">å†…å®¹åœ°å€</a> è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨ IPFS æ·»åŠ æ•°æ®ï¼Œå°†äº§ç”Ÿä¸€ä¸ª å†…å®¹idï¼ˆCIDï¼‰ï¼Œ<strong><strong>è¿™ä¸ª id æ¥æºäºæ•°æ®æœ¬èº«ï¼Œå¹¶åœ¨ IPFS ç½‘è·¯ä¸­é“¾æ¥ç€æ•°æ®ã€‚ç”±äºæ¯ä¸ª CID åªèƒ½å…³è”ä¸€ä»½å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ¯ä¸ªäººèƒ½æ›¿æ¢æˆ–è€…ä¿®æ”¹å†…å®¹ï¼Œè€Œä¸ç ´åè¿™ä¸ªé“¾æ¥ã€‚</strong></strong></p>
<p>é€šè¿‡ CIDï¼Œåªè¦æœ‰ä¸€ä¸ªå†…å®¹çš„å¤åˆ¶å“å­˜åœ¨äº IPFS ç½‘ç»œä¸­ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä» IPFS ç½‘ç»œä¸­è·å–åˆ°ä¸€ä»½æ•°æ®çš„å¤åˆ¶ï¼Œå³ä½¿æ•°æ®çš„åŸå§‹æä¾›è€…å·²ç»æ¶ˆå¤±äº†ã€‚è¿™ä½¿å¾— CID éå¸¸é€‚åˆ NFT å­˜å‚¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å°† CID æ”¾å…¥åˆ°ä¸€ä¸ª <code>ipfs://</code> çš„ URI ä¸­ï¼Œå°±åƒ <code>ipfs://bafybeidlkqhddsjrdue7y3dy27pu5d7ydyemcls4z24szlyik3we7vqvam/nft-image.png</code> ,ç„¶åï¼Œæˆ‘ä»¬ä¸ºåŒºå—é“¾ä¸Šçš„ token è·å¾—ä¸€ä¸ªä¸å˜çš„é“¾æ¥ã€‚</p>
<p>å½“ç„¶ï¼Œå¯¹äºå‘å¸ƒçš„ NFTï¼Œä½ å¯ä»¥è¿˜æœ‰æ”¹å˜å…¶ metadata çš„éœ€æ±‚ï¼Œè¿™å½“ç„¶ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œä½ åªéœ€è¦åœ¨æ™ºèƒ½åˆçº¦ä¸­æ·»åŠ å¯¹ token æ›´æ–°å…¶ URI çš„åŠŸèƒ½å³å¯ã€‚å½“ç„¶ï¼Œæœ€åˆçš„äº¤æ˜“å†å²ï¼Œè¿˜æ˜¯ä¼šè®°å½•åœ¨åŒºå—é“¾ä¸Šã€‚</p>
<h3 id="Minty"><a href="#Minty" class="headerlink" title="Minty"></a>Minty</h3><p>ä¸ºäº†å¸®åŠ©ä½ ç†è§£ NFTs å’Œ IPFS æ˜¯å¦‚ä½•ä¸€èµ·å·¥ä½œçš„ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œåº”ç”¨è‡ªåŠ¨é“¸é€  NFT ,å¹¶ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://estuary.tech/">Estuary</a>, <a target="_blank" rel="noopener" href="https://nft.storage/">nft.storage</a> æˆ–è€… <a target="_blank" rel="noopener" href="https://pinata.cloud/">Pinata</a> å°†å…¶ pin åˆ° IPFS ä¸Šã€‚è¿™ä¸ªåº”ç”¨ï¼Œå°±æ˜¯ Mintyã€‚</p>
<p>NFT äº§å“äº¤æ˜“å¹³å°ï¼Œç›¸å¯¹æ¥è¯´æ˜¯ä¸ªå¤æ‚çš„äº‹ç‰©ã€‚å°±åƒç°åœ¨çš„ web åº”ç”¨ä¸€æ ·ï¼Œå›´ç»•ç€æŠ€æœ¯æ ˆ&#x2F;ç”¨æˆ·äº¤äº’&#x2F;API è®¾è®¡ç­‰ï¼ŒNFT å¹³å°å®ç°ä¹Ÿæœ‰å¾ˆå¤šé€‰æ‹©ã€‚å†åŠ ä¸ŠåŸºäºåŒºå—é“¾çš„å»ä¸­å¿ƒåŒ– app éœ€è¦å¥½ä½¿ç”¨ç”¨æˆ·çš„é’±åŒ…ï¼ˆæ¯”å¦‚ <a target="_blank" rel="noopener" href="https://metamask.io/">Metamash</a>ï¼‰å®Œæˆäº¤äº’ï¼Œè¿™è¿›ä¸€æ­¥å¢åŠ äº†å…¶å¤æ‚æ€§ã€‚</p>
<p>ç”±äº Mintty ä»…ä»…æ˜¯è¢«ç”¨æ¥è¯æ˜åŸºäº IPFS çš„ NFT çš„æ¦‚å¿µåŠå…¶å¤„ç†è¿‡ç¨‹ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å®ç°ç°ä»£å»ä¸­å¿ƒåŒ– app å¼€å‘æ‰€éœ€è¦çš„æ‰€æœ‰ç»†èŠ‚ã€‚Minty ä»…ä»…æ˜¯ä¸€ä¸ªç”± JavaScrpit å®ç°çš„å‘½ä»¤è¡Œåº”ç”¨ã€‚</p>
<h4 id="å®‰è£…-Minty"><a href="#å®‰è£…-Minty" class="headerlink" title="å®‰è£… Minty"></a>å®‰è£… Minty</h4><p>è®©æˆ‘ä»¬å¼€å§‹å®‰è£… Mintyï¼Œä»¥å¼€å§‹ NFTs ä¹‹æ—…ã€‚ä¸ºäº†è¿è¡Œ Mintyï¼Œä½ è¿˜éœ€è¦å®‰è£… NPMã€‚Minty ç›®å‰å¹¶ä¸æ”¯æŒ Windows ç³»ç»Ÿã€‚å®‰è£… Minty çš„è¿‡ç¨‹éå¸¸ç®€å•ï¼Œåªéœ€è¦ä» GitHub ä»“åº“ä¸‹è½½ï¼Œå¹¶å®‰è£… NPM ä¾èµ–å³å¯ï¼Œå¹¶å¼€å¯æœ¬åœ°çš„ testnet ç¯å¢ƒå³å¯ã€‚</p>
<ol>
<li><p>ä» <a target="_blank" rel="noopener" href="https://github.com/yusefnapora/minty">Minty ä»“åº“åœ°å€</a> ä¸‹è½½é¡¹ç›®ï¼Œå¹¶è¿›å…¥åˆ° <code>minty</code> æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/yusefnapora/minty</span><br><span class="line">cd minty</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£… NPM ä¾èµ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°† <code>minty</code> æŒ‡ä»¤æ·»åŠ åˆ° <code>$PATH</code> ä¸­ï¼Œè¿™ä¸€æ­¥æ˜¯å¯é€‰çš„ï¼Œä½†æ˜¯è¿™ä¼šä½¿å¾—è¿è¡Œ Minty å˜å¾—ç®€å•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm link</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¥ç€ï¼Œè¿è¡Œ <code>start-local-environment.sh</code> è„šæœ¬ï¼Œè¯¥è„šæœ¬å°†å¼€å¯æœ¬åœ°ä»¥å¤ªåŠ testnet ç½‘ç»œï¼Œä»¥åŠ IPFS å®ˆæŠ¤è¿›ç¨‹ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./start-local-environment.sh</span><br><span class="line"></span><br><span class="line">&gt; Compiling smart contract</span><br><span class="line">&gt; Compiling 16 files with 0.7.3</span><br><span class="line">&gt; ...</span><br></pre></td></tr></table></figure></li>
</ol>
<p>è¿™ä¸ªæŒ‡ä»¤ï¼Œå°†æŒç»­è¿›è¡Œï¼Œå…¶ä»–æŒ‡ä»¤åº”å½“è¿è¡Œåœ¨å…¶å®ƒç»ˆç«¯çª—å£ä¸­ã€‚</p>
<h4 id="éƒ¨ç½²åˆçº¦"><a href="#éƒ¨ç½²åˆçº¦" class="headerlink" title="éƒ¨ç½²åˆçº¦"></a>éƒ¨ç½²åˆçº¦</h4><p>åœ¨è¿è¡Œä»»ä½•å…¶å®ƒ <code>minty</code> æŒ‡ä»¤ä¹‹å‰ï¼Œä½ è¿˜éœ€è¦éƒ¨ç½²æ™ºèƒ½åˆçº¦å®ä¾‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">minty deploy</span><br><span class="line"></span><br><span class="line">&gt; deploying contract <span class="keyword">for</span> token Julep (JLP) to network <span class="string">&quot;localhost&quot;</span>...</span><br><span class="line">&gt; deployed contract <span class="keyword">for</span> token Julep (JLP) to 0x5FbDB2315678afecb367f032d93F642f64180aa3 (network: localhost)</span><br><span class="line">&gt; Writing deployment info to minty-deployment.json</span><br></pre></td></tr></table></figure>

<p>éƒ¨ç½²çš„ç½‘ç»œé…ç½®ï¼Œæ˜¯åœ¨ <code>hardhat.config.js</code> ä¸­ï¼Œå…¶ä½¿ç”¨ <code>localhost</code> ä½œä¸ºé»˜è®¤ç½‘ç»œã€‚å¦‚æœä½ æ— æ³•åˆ°è¾¾è¯¥ç½‘ç»œï¼Œè¯·ç¡®ä¿ <code>start-local-environment.sh</code> å·²ç»è¢«æ‰§è¡Œäº†ã€‚</p>
<p>å½“åˆçº¦è¢«éƒ¨ç½²å¥½ä¹‹åï¼Œå…³äºéƒ¨ç½²çš„åœ°å€åŠå…¶å®ƒéƒ¨ç½²ä¿¡æ¯è¢«å†™åœ¨ <code>minty-deployment.json</code> ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å°†å‡ºç°åœ¨åç»­æŒ‡ä»¤ä¸­ã€‚</p>
<h4 id="é“¸é€ -NFT"><a href="#é“¸é€ -NFT" class="headerlink" title="é“¸é€  NFT"></a>é“¸é€  NFT</h4><p>ä¸€æ—¦æœ¬åœ°ä»¥å¤ªåŠç½‘ç»œåŠ IPFS å®ˆæŠ¤è¿›ç¨‹å¼€å§‹è¿è¡Œï¼Œé“¸é€  NFT å°±æ˜¾å¾—éš¾ä»¥ç½®ä¿¡çš„ç®€å•ã€‚ä½ åªéœ€è¦æŒ‡å®šä½ æƒ³è¦é€šè¯åŒ–çš„å¯¹è±¡ï¼ŒNFT çš„åå­—ï¼Œå¹¶å¯¹è¯¥ NFT æ·»åŠ æè¿°å³å¯ã€‚</p>
<h5 id="åˆ›å»ºæƒ³è¦é“¸é€ çš„å¯¹è±¡"><a href="#åˆ›å»ºæƒ³è¦é“¸é€ çš„å¯¹è±¡" class="headerlink" title="åˆ›å»ºæƒ³è¦é“¸é€ çš„å¯¹è±¡"></a>åˆ›å»ºæƒ³è¦é“¸é€ çš„å¯¹è±¡</h5><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºéœ€è¦é“¸é€ çš„å¯¹è±¡ã€‚NFTs æœ‰éå¸¸å®½æ³›çš„åº”ç”¨åœºæ™¯ï¼Œä½ å¯ä»¥é“¸é€ ä»»ä½•ä½ æƒ³é“¸é€ çš„å¯¹è±¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªé€šå¾€æœˆçƒçš„èˆªç­çš„ç¥¨ä½œä¸º NFT.</p>
<ol>
<li><p>åˆ›å»ºä¸€ä¸ªåå­—ä¸º <code>flight-to-the-moon.txt</code> çš„æ–‡ä»¶</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> ~/flight-to-the-moon.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è¾“å…¥èˆªç­ä¿¡æ¯</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------</span><br><span class="line">Departing: Cape Canaveral, Earth</span><br><span class="line">Arriving: Base 314, The Moon</span><br><span class="line">Boarding time: 17:30 UTC</span><br><span class="line">Seat number: 1A</span><br><span class="line">Baggage allowance: 5kg </span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚</p>
</li>
</ol>
<h5 id="é“¸é€ æ–‡ä»¶"><a href="#é“¸é€ æ–‡ä»¶" class="headerlink" title="é“¸é€ æ–‡ä»¶"></a>é“¸é€ æ–‡ä»¶</h5><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†é€šè¯åŒ–è¿™ä¸ªç¥¨æ®ï¼Œå¹¶å°†å…¶æ”¾å…¥åˆ°ä¸€ä¸ª NFT ä¸­ã€‚è¿™å°±æ˜¯ é“¸é€ (minting) çš„è¿‡ç¨‹ã€‚</p>
<ol>
<li>è°ƒç”¨ <code>mint</code> æŒ‡ä»¤ï¼Œå¹¶æä¾›è¦é“¸é€ çš„æ–‡ä»¶ï¼ŒNFT çš„åå­—ï¼ŒåŠå…¶æè¿°ã€‚<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">minty mint ~/flight-to-the-moon.txt --name <span class="string">&quot;Moon Flight #1&quot;</span> --description <span class="string">&quot;This ticket serves as proof-of-ownership of a first-class seat on a flight to the moon.&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; ğŸŒ¿ Minted a new NFT:</span><br><span class="line">&gt; Token ID:              1</span><br><span class="line">&gt; Metadata URI:          ipfs://bafybeic3ui4dj5dzsvqeiqbxjgg3fjmfmiinb3iyd2trixj2voe4jtefgq/metadata.json</span><br><span class="line">&gt; Metadata Gateway URL:  http://localhost:8080/ipfs/bafybeic3ui4dj5dzsvqeiqbxjgg3fjmfmiinb3iyd2trixj2voe4jtefgq/metadata.json</span><br><span class="line">&gt; Asset URI:             ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt</span><br><span class="line">&gt; Asset Gateway URL:     http://localhost:8080/ipfs/bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt</span><br><span class="line">&gt; NFT Metadata:</span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;   <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Moon Flight #1&quot;</span>,</span><br><span class="line">&gt;   <span class="string">&quot;description&quot;</span>: <span class="string">&quot;This ticket serves as proof-of-ownership of a first-class seat on a flight to the moon.&quot;</span>,</span><br><span class="line">&gt;   <span class="string">&quot;image&quot;</span>: <span class="string">&quot;ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/flight-to-the-moon.txt&quot;</span></span><br><span class="line">&gt; &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><code>minty mint</code> æŒ‡ä»¤å°†è¿”å›ä¸€ä¸ªæ–° token çš„ idï¼Œæˆ‘ä»¬æä¾›çš„ <code>name</code> å’Œ <code>description</code>ï¼ŒNFT èµ„äº§æ‰€æŒ‡å‘çš„ IPFS URI. ä¸Šè¿°è¾“å‡ºçš„ <code>Metadata URI</code> NFT Metadata JSON å¯¹è±¡å­˜å‚¨åœ¨ IPFS ä¸Šçš„ IPFS URIã€‚</p>
<p>OKï¼Œç°åœ¨ä½ å·²ç»åˆ›å»ºäº† NFT äº†ï¼Œåªè¦ä½ çš„ IPFS èŠ‚ç‚¹è¿è½¬ï¼Œè¿™ä¸ª NFT å¯¹å…¶ä»–äººæ¥è¯´ï¼Œå°±æ˜¯å¯è§çš„ã€‚å¦‚æœä½ å…³é—­äº†è‡ªå·±çš„ç”µè„‘ï¼Œæˆ–è€…å¤±å»äº†ç½‘ç»œè¿æ¥ï¼Œåˆ«äººå°±çœ‹ä¸åˆ°ä½ çš„ NFT äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦ pin è¿™ä¸ª NFT åˆ° pining service ä¸­ã€‚</p>
<h5 id="Pin-your-NFT"><a href="#Pin-your-NFT" class="headerlink" title="Pin your NFT"></a>Pin your NFT</h5><p>è¿™ä¸€éƒ¨åˆ†ï¼Œè®²å¦‚ä½•é€šè¿‡ç¬¬ä¸‰æ–¹å¹³å°ï¼Œå›ºå®š IPFS ï¼Œè¿™é‡Œæš‚æ—¶ä¸åšèµ˜è¿°ã€‚</p>
<h3 id="Minty-æ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#Minty-æ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="Minty æ˜¯å¦‚ä½•å·¥ä½œçš„"></a>Minty æ˜¯å¦‚ä½•å·¥ä½œçš„</h3><p>æˆ‘ä»¬å·²ç»é“¸é€ äº†ä¸€ä¸ª NFTï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°äº† ä»¥å¤ªåŠåŒºå—é“¾ ä¸Šï¼Œæ•°æ®æ‰˜ç®¡åœ¨ IPFS ä¸Šã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ·±ç©¶ä¸‹æ™ºèƒ½åˆçº¦åˆ°åº•åšäº†ä»€ä¹ˆä»¥åŠå®ƒä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚æˆ‘ä»¬è¿˜ä¼šæ¢ç´¢ IPFS ç«¯çš„å·¥ä½œä»¥åŠ NFT æœ¬èº«æ˜¯æ€æ ·å­˜å‚¨çš„ã€‚</p>
<h4 id="MintY-smart-contract"><a href="#MintY-smart-contract" class="headerlink" title="MintY smart-contract"></a>MintY smart-contract</h4><p>Minty ä½¿ç”¨çš„æ™ºèƒ½åˆçº¦æ˜¯ç”¨ <a target="_blank" rel="noopener" href="https://soliditylang.org/">Solidity</a> å†™çš„ï¼Œå®ƒæ˜¯æœ€å—æ¬¢è¿çš„ä»¥å¤ªåŠå¼€å‘è¯­è¨€ã€‚è¯¥åˆçº¦é€šè¿‡ç»§æ‰¿ <a target="_blank" rel="noopener" href="https://docs.openzeppelin.com/contracts/3.x/api/token/erc721#ERC721">OpenZeppelin ERC721 base contract</a> éå¸¸æ–¹ä¾¿å¿«æ·åœ°å®ç°äº† <a target="_blank" rel="noopener" href="https://eips.ethereum.org/EIPS/eip-721">ERC-721 Ethereum NFT standard</a>ã€‚</p>
<p>ç”±äºåŸºäº OpenZeppenlin çš„åˆçº¦ï¼Œå·²ç»æä¾›äº†éå¸¸å¤šçš„æ ¸å¿ƒåŸºç¡€åŠŸèƒ½ï¼Œå› æ­¤ï¼ŒMinty çš„åˆçº¦å°±éå¸¸ç®€å•äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.7.0;</span><br><span class="line"></span><br><span class="line">import &quot;hardhat/console.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/token/ERC721/ERC721.sol&quot;;</span><br><span class="line">import &quot;@openzeppelin/contracts/utils/Counters.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Minty is ERC721 &#123;</span><br><span class="line">    using Counters for Counters.Counter;</span><br><span class="line">    Counters.Counter private _tokenIds;</span><br><span class="line"></span><br><span class="line">    constructor(string memory tokenName, string memory symbol) ERC721(tokenName, symbol) &#123;</span><br><span class="line">        _setBaseURI(&quot;ipfs://&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function mintToken(address owner, string memory metadataURI)</span><br><span class="line">    public</span><br><span class="line">    returns (uint256)</span><br><span class="line">    &#123;</span><br><span class="line">        _tokenIds.increment();</span><br><span class="line"></span><br><span class="line">        uint256 id = _tokenIds.current();</span><br><span class="line">        _safeMint(owner, id);</span><br><span class="line">        _setTokenURI(id, metadataURI);</span><br><span class="line"></span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ è¯»äº† <a target="_blank" rel="noopener" href="https://docs.openzeppelin.com/contracts/3.x/erc721">OpenZeppelin ERC721 guide</a> ,ä½ å°†çœ‹åˆ° Minty contract ä¹Ÿæ˜¯æä¸ºç›¸ä¼¼çš„ã€‚å‡½æ•° <code>mintToken</code> é€šè¿‡è‡ªå¢è®¡æ•°å™¨çš„æ–¹å¼ï¼Œè§£å†³ token id é—®é¢˜ï¼Œå®ƒä½¿ç”¨åŸºç¡€åˆçº¦æ‰€æä¾›çš„  <code>_setTokenURI</code> å‡½æ•°å°† metadata URI å’Œ token id å…³è”èµ·æ¥ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨æ„é€ å™¨ä¸­å°† URI å‰ç¼€è®¾ç½®ä¸ºäº† <code>ipfs://</code>ã€‚å½“æˆ‘ä»¬åœ¨ <code>mintToken</code> ä¸ºæ¯ä¸ª token è®¾ç½® metadata URI æ—¶ï¼Œå°±ä¸éœ€è¦å†å­˜å‚¨è¿™ä¸ªå‰ç¼€äº†ï¼Œå› ä¸º åŸºç¡€åˆçº¦ï¼ˆbase contractï¼‰ çš„ tokenURI è®¿é—®å™¨å‡½æ•°ä¼šå°†è¯¥å‰ç¼€åº”ç”¨äºæ¯ä¸ª token URI ä¸­ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªéå¸¸é‡è¦çš„ç‚¹æ˜¯ï¼Œè¿™ä¸ªåˆçº¦å¹¶ä¸å°±æ˜¯å‡†å¤‡å¥½ç”¨äºæ­£å¼äº§å“ç¯å¢ƒä¸‹çš„åˆçº¦ï¼Œå®ƒå¹¶ä¸åŒ…å«ä»»ä½•é™åˆ¶è´¦æˆ·è®¿é—® <code>mintToken</code> å‡½æ•°çš„ <a target="_blank" rel="noopener" href="https://docs.openzeppelin.com/contracts/3.x/access-control">è®¿é—®æ§åˆ¶</a>ã€‚å¦‚æœä½ å¸Œæœ›åŸºäº Minty å¼€å‘ä¸€ä¸ªäº§å“å¹³å°ï¼Œè¯·æ·»åŠ è®¿é—®æ§åˆ¶æ¨¡å¼ã€‚</p>
<h4 id="éƒ¨ç½²åˆçº¦-1"><a href="#éƒ¨ç½²åˆçº¦-1" class="headerlink" title="éƒ¨ç½²åˆçº¦"></a>éƒ¨ç½²åˆçº¦</h4><p>åœ¨å¼€å§‹é“¸é€ æ–°çš„ NFTs ä¹‹å‰ï¼Œä½ éœ€è¦å°†æ™ºèƒ½åˆçº¦éƒ¨ç½²åˆ° åŒºå—é“¾ç½‘ç»œä¸­ã€‚Minty ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://hardhat.org/">HardHat</a> æ¥ç®¡ç†åˆçº¦çš„éƒ¨ç½²ã€‚é»˜è®¤åœ°ï¼ŒMinty å°†éƒ¨ç½²åˆçº¦å®ä¾‹åˆ° <a target="_blank" rel="noopener" href="https://hardhat.org/hardhat-network">HardHat development network</a> ä¸­ï¼Œè¯¥ç½‘ç»œè¢«é…ç½®å¹¶è¿è¡Œåœ¨ä½ ç”µè„‘çš„æœ¬åœ°ç½‘ç»œä¸­ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¼–è¾‘ <code>hardhat.config.js</code> æ–‡ä»¶çš„æ–¹å¼ï¼Œéƒ¨ç½²åˆçº¦åˆ° <a target="_blank" rel="noopener" href="https://ethereum.org/en/developers/docs/networks/">ä»¥å¤ªåŠæµ‹è¯•ç½‘ç»œ</a> ä¸­ã€‚æŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://hardhat.org/config/#json-rpc-based-networks">HardHat documentation</a> å¯ä»¥å­¦ä¹ å¦‚ä½•é…ç½® HardHat, ä»¥éƒ¨ç½²åˆ°ä¸€ä¸ªè¿æ¥åˆ° testnet çš„èŠ‚ç‚¹ä¸Šï¼›æˆ–è€…ï¼Œæœ¬åœ°è¿è¡Œçš„ä»¥å¤ªåŠç½‘ç»œï¼Œä¾‹å¦‚ <a target="_blank" rel="noopener" href="https://infura.io/">Infura</a>ã€‚ç”±äºéƒ¨ç½²è¿‡ç¨‹å°†æ¶ˆè€— ETH ä½œä¸ºæ²¹è´¹ï¼Œä½ è¿˜éœ€è¦åœ¨ä½ çš„æµ‹è¯•ç½‘è·¯ä¸­ï¼Œè·å–ä¸€äº›å¯ä»¥æµ‹è¯•ä½¿ç”¨çš„ ETH.</p>
<h4 id="è°ƒç”¨-mintToken-å‡½æ•°"><a href="#è°ƒç”¨-mintToken-å‡½æ•°" class="headerlink" title="è°ƒç”¨ mintToken å‡½æ•°"></a>è°ƒç”¨ <code>mintToken</code> å‡½æ•°</h4><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Minty ä¸­çš„ JavaScript ä»£ç æ˜¯å¦‚ä½•å’Œæ™ºèƒ½åˆçº¦çš„ <code>mintToken</code> å‡½æ•°äº¤äº’çš„ã€‚è¿™ç§äº¤äº’å‘ç”Ÿåœ¨ <code>Minty</code> ç±»ä¸­çš„ <code>mintToken</code> æ–¹æ³•ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">mintToken</span>(<span class="params">ownerAddress, metadataURI</span>) &#123;</span><br><span class="line">  <span class="comment">// The smart contract adds an ipfs:// prefix to all URIs, </span></span><br><span class="line">  <span class="comment">// so make sure to remove it so it doesn&#x27;t get added twice</span></span><br><span class="line">  metadataURI = <span class="title function_">stripIpfsUriPrefix</span>(metadataURI)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Call the mintToken smart contract function to issue a new token</span></span><br><span class="line">  <span class="comment">// to the given address. This returns a transaction object, but the </span></span><br><span class="line">  <span class="comment">// transaction hasn&#x27;t been confirmed yet, so it doesn&#x27;t have our token id.</span></span><br><span class="line">  <span class="keyword">const</span> tx = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">contract</span>.<span class="title function_">mintToken</span>(ownerAddress, metadataURI)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The OpenZeppelin base ERC721 contract emits a Transfer event </span></span><br><span class="line">  <span class="comment">// when a token is issued. tx.wait() will wait until a block containing </span></span><br><span class="line">  <span class="comment">// our transaction has been mined and confirmed. The transaction receipt </span></span><br><span class="line">  <span class="comment">// contains events emitted while processing the transaction.</span></span><br><span class="line">  <span class="keyword">const</span> receipt = <span class="keyword">await</span> tx.<span class="title function_">wait</span>()</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> event <span class="keyword">of</span> receipt.<span class="property">events</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (event.<span class="property">event</span> !== <span class="string">&#x27;Transfer&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ignoring unknown event type &#x27;</span>, event.<span class="property">event</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> event.<span class="property">args</span>.<span class="property">tokenId</span>.<span class="title function_">toString</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;unable to get token id&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚ä½ æ‰€è§ï¼Œè°ƒç”¨æ™ºèƒ½åˆçº¦çš„å‡½æ•°ï¼Œå’Œè°ƒç”¨æ™®é€šçš„ JavaScript å‡½æ•°éå¸¸åƒï¼Œè¿™éƒ½è¦æ„Ÿè°¢ <a target="_blank" rel="noopener" href="https://docs.ethers.io/v5/">ethers.js smart contract library</a>ã€‚ç„¶è€Œï¼Œç”±äº <code>mintToken</code> å‡½æ•°æ”¹å˜äº†åŒºå—é“¾çš„çŠ¶æ€ï¼Œå®ƒç»“æœå¹¶ä¸èƒ½è¢«ç«‹å³è¿”å›ã€‚è¿™æ˜¯å› ä¸ºï¼Œå‡½æ•°è°ƒç”¨å°†åˆ›å»ºä¸€ä¸ªä»¥å¤ªåŠäº¤æ˜“ï¼Œæˆ‘ä»¬æ— æ³•ç«‹å³çŸ¥é“å¹¶ç¡®è®¤åŒ…å«è¯¥äº¤æ˜“çš„åŒºå—æ˜¯å¦å·²ç»çŸ¿å·¥æŒ–å‡ºæ¥å¹¶æ”¾å…¥åˆ°åŒºå—é“¾ä¸Šã€‚æ¯”å¦‚è¯´ï¼Œå¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„ gas æ¥æ”¯ä»˜è¿™ä¸ªäº¤æ˜“ã€‚</p>
<p>ä¸ºäº†è·å–æ–° NFT çš„ token idï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>tx.wait()</code> ï¼Œå…¶å°†ä¸€ç›´ç­‰åˆ°äº¤æ˜“è¢«ç¡®è®¤ã€‚ token id è¢«å°è£…åœ¨ <code>Tansfer</code> äº‹ä»¶å†…ï¼Œè¯¥äº‹ä»¶ç”± base contract ï¼ˆåˆçº¦åŸºç±»ï¼‰åœ¨æ–°çš„ token è¢«åˆ›å»ºåæˆ–è€…å·²ç»è½¬æ¢ç»™ä¸€ä¸ªæ–°çš„æ‹¥æœ‰è€…æ—¶å‘å°„å‡ºæ¥çš„ã€‚</p>
<h4 id="å°†-NFT-æ•°æ®å­˜å‚¨åˆ°-IPFS-ä¸Š"><a href="#å°†-NFT-æ•°æ®å­˜å‚¨åˆ°-IPFS-ä¸Š" class="headerlink" title="å°† NFT æ•°æ®å­˜å‚¨åˆ° IPFS ä¸Š"></a>å°† NFT æ•°æ®å­˜å‚¨åˆ° IPFS ä¸Š</h4><p>æ™ºèƒ½åˆçº¦çš„ <code>mintToken</code> å‡½æ•°æœŸæœ›å¾—åˆ°ä¸€ä¸ª IPFS metadata URIï¼Œå…¶æŒ‡å‘äº†ä¸€ä¸ªæè¿° NFT çš„ JSON æ–‡ä»¶ã€‚Minty ä½¿ç”¨çš„ metadata schema åœ¨ <a target="_blank" rel="noopener" href="https://eips.ethereum.org/EIPS/eip-721">EIP-721</a> ä¸­æœ‰æè¿°ï¼Œå…¶æ”¯æŒçš„ JSON å¯¹è±¡é•¿è¿™æ ·ï¼š</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;A name for this NFT&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;An in-depth description of the NFT&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;image&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ipfs://bafybeidlkqhddsjrdue7y3dy27pu5d7ydyemcls4z24szlyik3we7vqvam/nft-image.png&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><code>image</code> åŒ…å«äº†æŒ‡å‘ NFT å›¾ç‰‡æ•°æ®çš„ URI.è¯¥ URI åŒæ ·å’Œ token å…³è”åœ¨ä¸€èµ·ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåŸŸä¸éœ€è¦ä¸€å®šè¦æŒ‡å‘ä¸€ä¸ªå›¾ç‰‡ï¼Œå®é™…ä¸Šå®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„æ–‡ä»¶ã€‚</p>
<p>ä¸ºäº†è·å– metadata URIï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ­£èµ› IPFS ä¸Šæ·»åŠ ä¸€ä¸ª å›¾ç‰‡æ•°æ®ï¼Œå¹¶è·å–å…¶ IPFS <a target="_blank" rel="noopener" href="https://docs.ipfs.io/concepts/content-addressing/">CID</a>ï¼Œå¹¶ä½¿ç”¨ CID æ„å»ºä¸€ä¸ª <code>ipfs://</code> URI. æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å«äº†è¿™ä¸ª image URI &#x2F; name &#x2F; description åŸŸçš„ JSON å¯¹è±¡ï¼Œæœ€åï¼Œæˆ‘ä»¬å°†æ·»åŠ  JSON æ•°æ®åˆ° IPFS ä¸Šï¼Œå¹¶è·å–åˆ°äº† metadata â€˜ipfs:&#x2F;&#x2F;â€˜ URI, æˆ‘ä»¬å°†è¿™ä¸ª URI æ”¾å…¥åˆ° æ™ºèƒ½åˆçº¦ä¸­ã€‚</p>
<p>Minty çš„ <code>createNFTFromAssetData</code> æ–¹æ³•è´Ÿè´£å¤„ç†è¿™ä¸ªè¿‡ç¨‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">createNFTFromAssetData</span>(<span class="params">content, options</span>) &#123;</span><br><span class="line">  <span class="comment">// add the asset to IPFS</span></span><br><span class="line">  <span class="keyword">const</span> filePath = options.<span class="property">path</span> || <span class="string">&#x27;asset.bin&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> basename =  path.<span class="title function_">basename</span>(filePath)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// When you add an object to IPFS with a directory prefix in its path,</span></span><br><span class="line">  <span class="comment">// IPFS will create a directory structure for you. This is nice, because</span></span><br><span class="line">  <span class="comment">// it gives us URIs with descriptive filenames in them e.g.</span></span><br><span class="line">  <span class="comment">// &#x27;ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq/cat-pic.png&#x27; vs</span></span><br><span class="line">  <span class="comment">// &#x27;ipfs://bafybeihhii26gwp4w7b7w7d57nuuqeexau4pnnhrmckikaukjuei2dl3fq&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> ipfsPath = <span class="string">&#x27;/nft/&#x27;</span> + basename</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">cid</span>: assetCid &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">ipfs</span>.<span class="title function_">add</span>(&#123; <span class="attr">path</span>: ipfsPath, content &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// make the NFT metadata JSON</span></span><br><span class="line">  <span class="keyword">const</span> assetURI = <span class="title function_">ensureIpfsUriPrefix</span>(assetCid) + <span class="string">&#x27;/&#x27;</span> + basename</span><br><span class="line">  <span class="keyword">const</span> metadata = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">makeNFTMetadata</span>(assetURI, options)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// add the metadata to IPFS</span></span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">cid</span>: metadataCid &#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">ipfs</span>.<span class="title function_">add</span>(&#123; </span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/nft/metadata.json&#x27;</span>, </span><br><span class="line">    <span class="attr">content</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(metadata)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">const</span> metadataURI = <span class="title function_">ensureIpfsUriPrefix</span>(metadataCid) + <span class="string">&#x27;/metadata.json&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the address of the token owner from options, </span></span><br><span class="line">  <span class="comment">// or use the default signing address if no owner is given</span></span><br><span class="line">  <span class="keyword">let</span> ownerAddress = options.<span class="property">owner</span></span><br><span class="line">  <span class="keyword">if</span> (!ownerAddress) &#123;</span><br><span class="line">    ownerAddress = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">defaultOwnerAddress</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// mint a new token referencing the metadata URI</span></span><br><span class="line">  <span class="keyword">const</span> tokenId = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">mintToken</span>(ownerAddress, metadataURI)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// format and return the results</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    tokenId,</span><br><span class="line">    metadata,</span><br><span class="line">    assetURI,</span><br><span class="line">    metadataURI,</span><br><span class="line">    <span class="attr">assetGatewayURL</span>: <span class="title function_">makeGatewayURL</span>(assetURI),</span><br><span class="line">    <span class="attr">metadataGatewayURL</span>: <span class="title function_">makeGatewayURL</span>(metadataURI),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä½¿ç”¨å…·æœ‰ç›®å½•ç»“æ„ï¼ˆ<code>/nft/metadata.json</code>ï¼‰çš„ <code>path</code> å‚æ•°æ›¿ä»£ <code>metadata.json</code>ï¼Œæ¥æ·»åŠ æ•°æ®åˆ° IPFS ä¸­ï¼Œè¿™å¹¶ä¸æ˜¯ä¸¥æ ¼éœ€è¦çš„ï¼Œä½†æ˜¯å®ƒä¸ºæˆ‘ä»¬æä¾›äº†æ›´å…·äººç±»å¯è¯»æ€§çš„ URIï¼Œç„¶è€Œï¼Œè¿™æ ·ä¼šå¯¼è‡´ç”Ÿäº§ç¯å¢ƒä¸‹ä¸Šé“¾çš„è´Ÿæ‹…ï¼Œæ›´è¯¦ç»†çš„è·¯å¾„ï¼Œäº¤æ˜“æ•°æ®ä¹Ÿä¼šéšä¹‹å¢å¤§ã€‚ä½ å¯ä»¥ä¿®æ”¹æ™ºèƒ½åˆçº¦ï¼Œä»…å­˜å‚¨ CID éƒ¨åˆ†ï¼Œå¹¶åœ¨è¿”å› URI ä¹‹å‰ï¼Œè‡ªåŠ¨é™„åŠ æ–‡ä»¶åï¼Œæˆ–è€…è¿›å­˜å‚¨å…ƒæ•°æ®è€Œä¸é€‚ç”¨ç›®å½•åŒ…è£…ã€‚</p>
<h4 id="æ£€ç´¢-NFT-æ•°æ®"><a href="#æ£€ç´¢-NFT-æ•°æ®" class="headerlink" title="æ£€ç´¢ NFT æ•°æ®"></a>æ£€ç´¢ NFT æ•°æ®</h4><p>ä¸ºäº†æŸ¥çœ‹å·²ç»å­˜åœ¨ NFT ä¸­çš„ metadataï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>tokenURI</code> å‡½æ•°ï¼Œä» IPFS ä¸Šè·å– JSON æ–‡ä»¶ï¼Œå¹¶è§£ææˆå¯¹è±¡ã€‚è¯¥è¿‡ç¨‹å‘ç”Ÿåœ¨ <code>getNFTMetadata</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">getNFTMetadata</span>(<span class="params">tokenId</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> metadataURI = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">contract</span>.<span class="title function_">tokenURI</span>(tokenId)</span><br><span class="line">  <span class="keyword">const</span> metadata = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getIPFSJSON</span>(metadataURI)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;metadata, metadataURI&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>getNFT</code> <a target="_blank" rel="noopener" href="https://github.com/yusefnapora/minty/blob/39a3e79e01b4776372a08fa352c8fe508ffa9845/src/minty.js#L193-L212">æ–¹æ³•</a> ä¹Ÿå¯ä»¥è·å– IPFS ä¸Šçš„èµ„äº§æ•°æ®ã€‚</p>
<p><code>geNFT</code> æ–¹æ³•è¢« <code>minty</code> å‘½ä»¤è¡Œåº”ç”¨ä½¿ç”¨ï¼Œå…·ä½“åº”ä½¿ç”¨ <code>minty show &lt;token-id&gt;</code> æŒ‡ä»¤:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">minty show 14</span><br><span class="line"></span><br><span class="line">Token ID:              14</span><br><span class="line">Owner Address:         0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266</span><br><span class="line">Metadata URI:          ipfs://bafybeieeomufuwkwf7sbhyo7yiifaiknm7cht5tc3vakn25vbvazyasp3u/metadata.json</span><br><span class="line">Metadata Gateway URL:  http://localhost:8080/ipfs/bafybeieeomufuwkwf7sbhyo7yiifaiknm7cht5tc3vakn25vbvazyasp3u/metadata.json</span><br><span class="line">Asset URI:             ipfs://bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png</span><br><span class="line">Asset Gateway URL:     http://localhost:8080/ipfs/bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png</span><br><span class="line">NFT Metadata:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;The IPFS Logo&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;The IPFS logo (768px, png)&quot;</span>,</span><br><span class="line">  <span class="string">&quot;image&quot;</span>: <span class="string">&quot;ipfs://bafybeifszd4wbkeekwzwitvgijrw6zkzijxutm4kdumkxnc6677drtslni/ipfs-logo-768px.png&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ å®‰è£…äº† IPFS æµè§ˆå™¨ï¼Œæ¯”å¦‚ <a target="_blank" rel="noopener" href="https://brave.com/">Brave</a>, ä½ å¯ä»¥åœ¨åœ°å€æ ç²˜è´´ <code>Asset URI</code> æˆ–è€… <code>Metadata URI</code> ï¼Œå°†çœ‹åˆ°æ¥è‡ªæœ¬åœ° IPFS èŠ‚ç‚¹è¿”å›çš„ç»“æœã€‚</p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/æ™ºèƒ½åˆçº¦/">æ™ºèƒ½åˆçº¦</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/æ™ºèƒ½åˆçº¦/">æ™ºèƒ½åˆçº¦</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    
    &copy; 2023 YueGS
    
  </p>
</footer>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-116967169-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-116967169-1');
</script>

    
  </div>
</div>
</body>
</html>